<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PHOTOS</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { padding: 20px; background: #f8f9fa; }
    .photo-card img { width: 100%; height: 180px; object-fit: cover; border-radius: 8px; }
    .photo-title { font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  </style>
</head>
<body>
  <div class="container">
    <h2 class="mb-4 text-center">ðŸ“¸ YOUR LOVELY PHOTOS PRIYA</h2>
    <div id="status" class="mb-3 text-center text-muted"></div>
    <div id="gallery" class="row g-3"></div>
  </div>

  <script>
    // ðŸ‘‡ Aapka API key aur Folder ID
    const API_KEY = "AIzaSyACL1BBtMdua_vQKbsGr2jUDeXphnDTFkI";
    const FOLDER_ID = "1zF3ZfWBc-YrnZ-tJQqQDSq0lSIEobchg";

    const statusEl = document.getElementById("status");
    const gallery = document.getElementById("gallery");

    function updateStatus(msg) {
      statusEl.textContent = msg;
    }

    async function listImageFilesInFolder(folderId) {
      const q = `'${folderId}' in parents and (mimeType contains 'image/') and trashed = false`;
      const url = `https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent(q)}&pageSize=1000&fields=files(id,name,mimeType,thumbnailLink,webViewLink,webContentLink)&key=${API_KEY}`;
      const r = await fetch(url);
      if (!r.ok) throw new Error("Drive API request failed: " + r.status);
      const data = await r.json();
      return data.files;
    }

    function renderFiles(files) {
      gallery.innerHTML = "";
      files.forEach(f => {
        const col = document.createElement("div");
        col.className = "col-12 col-sm-6 col-md-4 col-lg-3"; // responsive grid

        const card = document.createElement("div");
        card.className = "card shadow-sm h-100 photo-card";

        const img = document.createElement("img");
        img.src = f.thumbnailLink || `https://drive.google.com/uc?export=view&id=${f.id}`;
        img.alt = f.name;

        const body = document.createElement("div");
        body.className = "card-body p-2 d-flex flex-column";

        const title = document.createElement("div");
        title.className = "photo-title mb-2";
        title.textContent = f.name;

        const btnGroup = document.createElement("div");
        btnGroup.className = "mt-auto d-flex justify-content-between";

        const dlBtn = document.createElement("a");
        dlBtn.className = "btn btn-sm btn-primary";
        dlBtn.textContent = "Download";
        dlBtn.href = `https://drive.google.com/uc?export=download&id=${f.id}`;
        dlBtn.target = "_blank";

        const viewBtn = document.createElement("a");
        viewBtn.className = "btn btn-sm btn-outline-secondary";
        viewBtn.textContent = "Open";
        viewBtn.href = f.webViewLink || `https://drive.google.com/file/d/${f.id}/view`;
        viewBtn.target = "_blank";

        btnGroup.appendChild(dlBtn);
        btnGroup.appendChild(viewBtn);

        body.appendChild(title);
        body.appendChild(btnGroup);

        card.appendChild(img);
        card.appendChild(body);
        col.appendChild(card);
        gallery.appendChild(col);
      });
    }

    async function init() {
      try {
        updateStatus("Loading photos...");
        const files = await listImageFilesInFolder(FOLDER_ID);
        if (!files || files.length === 0) {
          updateStatus("No images found or folder is not shared publicly.");
          return;
        }
        updateStatus(`Found ${files.length} image(s)`);
        renderFiles(files);
      } catch (e) {
        console.error(e);
        updateStatus("Error loading files. Check API key, folder ID, and sharing permissions.");
      }
    }

    window.onload = init;
  </script>
</body>
</html>
